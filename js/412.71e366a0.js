"use strict";(self["webpackChunkweek8_0626"]=self["webpackChunkweek8_0626"]||[]).push([[412],{5818:function(e,a,s){s.r(a),s.d(a,{default:function(){return R}});var t=s(6252),o=s(3577),l=s(9963);const i=e=>((0,t.dD)("data-v-72a4eeea"),e=e(),(0,t.Cn)(),e),c={id:"main-checkout"},n={class:"container-fluid con-checkout"},r={class:"row justify-content-center"},d=i((()=>(0,t._)("div",{class:"step"},[(0,t._)("div",{class:"step-status step-confirm finish"},[(0,t._)("span",null,"1"),(0,t.Uk)(" 購物車 ")]),(0,t._)("div",{class:"step-status step-fill finish"},[(0,t._)("span",null,"2"),(0,t.Uk)(" 填寫資料 ")]),(0,t._)("div",{class:"step-status step-finish"},[(0,t._)("span",null,"3"),(0,t.Uk)(" 完成訂單 ")])],-1))),u={class:"con-checkout-inner"},m={class:"row"},p={class:"col-12 col-md-6 order-data"},h=i((()=>(0,t._)("h3",null,"訂單內容",-1))),v={class:"order-data-inner"},_={class:"mb-2"},f=(0,t.uE)('<div class="cart-list-title" data-v-72a4eeea><div class="data" data-v-72a4eeea>商品資料</div><div class="unitPrice d-none d-sm-block" data-v-72a4eeea>單價</div><div class="count d-none d-sm-block" data-v-72a4eeea>數量</div><div class="totalPrice d-none d-sm-block" data-v-72a4eeea>小計</div></div>',1),b={class:"pic"},g=["src","alt"],k={class:"title"},w={class:"unitPrice"},C={class:"count"},$=i((()=>(0,t._)("span",{class:"mb-show"},"數量 :",-1))),y={class:"totalPrice"},V=i((()=>(0,t._)("span",{class:"d-sm-none"},"小計",-1))),T={class:"p-1 sum"},W=i((()=>(0,t._)("span",null,"小計：",-1))),N={class:"p-1 sum"},U=i((()=>(0,t._)("span",null,"運費：",-1))),x={class:"p-1 sum"},z=i((()=>(0,t._)("span",null,"優惠碼：",-1))),q={class:"p-1 sum"},F=i((()=>(0,t._)("span",null,"合計：",-1))),D={class:"col-12 col-md-6 order-tote"},O=i((()=>(0,t._)("h3",null,"送貨資料",-1))),L={class:"order-tote-inner"},E={class:"mb-3"},P=i((()=>(0,t._)("label",{for:"consigneeName",class:"form-label"}," 收件人名稱 ",-1))),S={class:"mb-3"},I=i((()=>(0,t._)("label",{for:"email",class:"form-label"}," 收件人電子信箱 ",-1))),j={class:"mb-3"},B=i((()=>(0,t._)("label",{for:"consigneeTel",class:"form-label"}," 收件人電話號碼 ",-1))),H={class:"mb-3"},J=i((()=>(0,t._)("label",{for:"consigneeAddress",class:"form-label"}," 收件人地址",-1))),Y=["onClick"],Z=(0,t.Uk)(" 返回購物車 ");function A(e,a,s,i,A,K){const G=(0,t.up)("VLoading"),M=(0,t.up)("NavBar"),Q=(0,t.up)("v-Field"),R=(0,t.up)("error-message"),X=(0,t.up)("router-link"),ee=(0,t.up)("v-Form");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(G,{active:A.isLoading},null,8,["active"]),(0,t.Wm)(M),(0,t._)("main",c,[(0,t._)("div",n,[(0,t._)("div",r,[d,(0,t._)("div",u,[(0,t._)("div",m,[(0,t.wy)((0,t._)("div",p,[h,(0,t._)("div",v,[(0,t._)("div",_,"購物車（"+(0,o.zw)(A.carts.length)+"件）",1),f,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(A.carts,(a=>((0,t.wg)(),(0,t.iD)("div",{class:"cart-list-item",key:a.id},[(0,t._)("div",b,[(0,t._)("img",{src:a.product.imageUrl,alt:a.product.title,class:"img-fluid"},null,8,g)]),(0,t._)("div",k,(0,o.zw)(a.product.title),1),(0,t._)("div",w,(0,o.zw)(e.$currency(a.product.price)),1),(0,t._)("div",C,[$,(0,t.Uk)(" "+(0,o.zw)(a.qty),1)]),(0,t._)("div",y,[V,(0,t.Uk)(" "+(0,o.zw)(e.$currency(a.total)),1)])])))),128)),(0,t._)("div",T,[W,(0,t._)("span",null,(0,o.zw)(e.$currency(A.final_total)),1)]),(0,t._)("div",N,[U,(0,t._)("span",null,(0,o.zw)(e.$currency(A.fare)),1)]),(0,t.wy)((0,t._)("div",x,[z,(0,t._)("span",null,(0,o.zw)(A.couponCode),1)],512),[[l.F8,A.couponCode]]),(0,t._)("div",q,[F,(0,t._)("span",null,(0,o.zw)(e.$currency(A.tempTotal)),1)])])],512),[[l.F8,0!==A.carts.length]]),(0,t.wy)((0,t._)("div",D,[O,(0,t._)("div",L,[(0,t.Wm)(ee,{onSubmit:K.cartEnd},{default:(0,t.w5)((({errors:e,validate:s})=>[(0,t._)("div",E,[P,(0,t.Wm)(Q,{id:"consigneeName",name:"姓名",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["姓名"]}]),rules:"required",modelValue:A.form.user.name,"onUpdate:modelValue":a[0]||(a[0]=e=>A.form.user.name=e)},null,8,["class","modelValue"]),(0,t.Wm)(R,{name:"姓名",class:"invalid-feedback"})]),(0,t._)("div",S,[I,(0,t.Wm)(Q,{id:"email",name:"信箱",type:"email",class:(0,o.C_)(["form-control",{"is-invalid":e["信箱"]}]),rules:"email|required",modelValue:A.form.user.email,"onUpdate:modelValue":a[1]||(a[1]=e=>A.form.user.email=e)},null,8,["class","modelValue"]),(0,t.Wm)(R,{name:"信箱",class:"invalid-feedback"})]),(0,t._)("div",j,[B,(0,t.Wm)(Q,{id:"consigneeName",name:"電話",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["電話"]}]),rules:"required|min:8|max:10",modelValue:A.form.user.tel,"onUpdate:modelValue":a[2]||(a[2]=e=>A.form.user.tel=e)},null,8,["class","modelValue"]),(0,t.Wm)(R,{name:"電話",class:"invalid-feedback"})]),(0,t._)("div",H,[J,(0,t.Wm)(Q,{id:"consigneeEmail",name:"地址",type:"email",class:(0,o.C_)(["form-control",{"is-invalid":e["地址"]}]),rules:"required",modelValue:A.form.user.address,"onUpdate:modelValue":a[3]||(a[3]=e=>A.form.user.address=e)},null,8,["class","modelValue"]),(0,t.Wm)(R,{name:"地址",class:"invalid-feedback"})]),(0,t._)("button",{type:"submit",class:"btn btn-next mb-2",onClick:s}," 提交訂單 ",8,Y),(0,t.Wm)(X,{class:"",to:"/cart"},{default:(0,t.w5)((()=>[Z])),_:1})])),_:1},8,["onSubmit"])])],512),[[l.F8,0!==A.carts.length]])])])])])])],64)}var K=s(902),G={name:"CartView",data(){return{products:[],carts:[],final_total:0,total:0,couponCode:"",fare:!1,pay:"貨到付款",tote:"宅配",tempTotal:0,form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},components:{NavBar:K.Z},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/v2",a="vue_cu";this.isLoading=!0,this.$http.get(`${e}/api/${a}/cart`).then((e=>{this.carts=e.data.data.carts,this.final_total=e.data.data.final_total,this.total=e.data.data.total,this.isLoading=!1,this.countTempTotal()})).catch((e=>{console.dir(e.response.data.message)}))},countTempTotal(){switch(this.couponCode){case"Ninniku75":this.tempTotal=.75*(this.final_total+this.fare);break;case"Ninniku85":this.tempTotal=.85*(this.final_total+this.fare);break;case"Ninniku90":this.tempTotal=.9*(this.final_total+this.fare);break;default:this.tempTotal=this.final_total+this.fare;break}},addToCart(e){const a="https://vue3-course-api.hexschool.io/v2",s="vue_cu",t={data:{product_id:e,qty:1}};this.$http.post(`${a}/api/${s}/cart`,t).then((e=>{})).catch((e=>{console.dir(e.response.data.message)}))},addFare(){const e="https://vue3-course-api.hexschool.io/v2",a="vue_cu",s={data:{product_id:"-N6i1qTb53JNo27jsmeD",qty:1}};this.$http.post(`${e}/api/${a}/cart`,s).then((e=>{this.couponCode?this.addCoupon(this.couponCode):this.createOrder()})).catch((e=>{console.dir(e.response.data.message)}))},addCoupon(e){const a="https://vue3-course-api.hexschool.io/v2",s="vue_cu",t={code:e};this.$http.post(`${a}/api/${s}/coupon`,{data:t}).then((e=>{this.createOrder()})).catch((e=>{console.dir(e.response.data.message)}))},cartEnd(){this.fare?this.addFare():this.couponCode?this.addCoupon(this.couponCode):this.createOrder()},createOrder(){const e="https://vue3-course-api.hexschool.io/v2",a="vue_cu";this.form.user.tote=this.tote,this.form.user.pay=this.pay;const s=this.form;this.$http.post(`${e}/api/${a}/order`,{data:s}).then((e=>{this.$router.push(`/order/${e.data.orderId}`)})).catch((e=>{console.log(e)}))},getOrder(){const e="https://vue3-course-api.hexschool.io/v2",a="vue_cu";this.$http.get(`${e}/api/${a}/orders`).then((e=>{})).catch((e=>{console.log(e)}))}},mounted(){this.getCart();const e=JSON.parse(localStorage.getItem("orderData"));this.couponCode=e.couponCode,this.fare=e.fare,this.pay=e.pay,this.tote=e.tote}},M=s(3744);const Q=(0,M.Z)(G,[["render",A],["__scopeId","data-v-72a4eeea"]]);var R=Q}}]);
//# sourceMappingURL=412.71e366a0.js.map